<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Dashboard View -->
    <record id="view_tai_chinh_dashboard_form" model="ir.ui.view">
        <field name="name">tai.chinh.ke.toan.dashboard.form</field>
        <field name="model">tai.chinh.ke.toan.dashboard</field>
        <field name="arch" type="xml">
            <form create="false" delete="false">
                <header>
                    <button name="action_refresh_dashboard" type="object" string="üîÑ L√†m m·ªõi" class="btn-primary"/>
                </header>
                <sheet>
                    <div class="oe_title mb-3">
                        <h1 style="color: #10b981;">üí∞ Dashboard T√†i ch√≠nh - K·∫ø to√°n</h1>
                        <p style="color: #6b7280;">T·ªïng quan t√¨nh h√¨nh thu chi v√† t·ªìn qu·ªπ ‚Ä¢ <i class="fa fa-clock-o"/> C·∫≠p nh·∫≠t t·ª± ƒë·ªông</p>
                    </div>
                    
                    <!-- PH·∫¶N 1: T·ªîNG QUAN THU CHI TH√ÅNG N√ÄY -->
                    <div class="mb-4">
                        <h3 style="color: #374151; font-weight: 600; margin-bottom: 1rem; padding: 0.75rem; background: #f9fafb; border-left: 4px solid #10b981;">
                            üìä T·ªîNG QUAN THU CHI TH√ÅNG N√ÄY
                        </h3>
                        <div class="o_row mt-2 mb-3">
                            <div class="o_col-3 mb-3">
                                <div class="card shadow-sm border-0" style="border-left: 4px solid #10b981 !important; background: linear-gradient(135deg, #34d399 0%, #10b981 100%);">
                                    <div class="card-body text-center text-white py-4">
                                        <i class="fa fa-arrow-down fa-2x mb-2" style="opacity: 0.8;"/>
                                        <h2 style="font-size: 2rem; font-weight: bold; margin-bottom: 0.5rem;">
                                            <field name="tong_thu_thang" widget="monetary" nolabel="1"/>
                                        </h2>
                                        <p class="mb-2" style="font-size: 1rem; font-weight: 500;">T·ªîNG THU</p>
                                        <div class="mt-2 pt-2" style="border-top: 1px solid rgba(255,255,255,0.3); font-size: 0.85rem;">
                                            <i class="fa fa-line-chart"/> 
                                            <field name="ty_le_tang_giam_thu" nolabel="1"/>% so th√°ng tr∆∞·ªõc
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="o_col-3 mb-3">
                                <div class="card shadow-sm border-0" style="border-left: 4px solid #ef4444 !important; background: linear-gradient(135deg, #f87171 0%, #ef4444 100%);">
                                    <div class="card-body text-center text-white py-4">
                                        <i class="fa fa-arrow-up fa-2x mb-2" style="opacity: 0.8;"/>
                                        <h2 style="font-size: 2rem; font-weight: bold; margin-bottom: 0.5rem;">
                                            <field name="tong_chi_thang" widget="monetary" nolabel="1"/>
                                        </h2>
                                        <p class="mb-2" style="font-size: 1rem; font-weight: 500;">T·ªîNG CHI</p>
                                        <div class="mt-2 pt-2" style="border-top: 1px solid rgba(255,255,255,0.3); font-size: 0.85rem;">
                                            <i class="fa fa-line-chart"/> 
                                            <field name="ty_le_tang_giam_chi" nolabel="1"/>% so th√°ng tr∆∞·ªõc
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="o_col-3 mb-3">
                                <div class="card shadow-sm border-0" style="border-left: 4px solid #3b82f6 !important; background: linear-gradient(135deg, #60a5fa 0%, #3b82f6 100%);">
                                    <div class="card-body text-center text-white py-4">
                                        <i class="fa fa-balance-scale fa-2x mb-2" style="opacity: 0.8;"/>
                                        <h2 style="font-size: 2rem; font-weight: bold; margin-bottom: 0.5rem;">
                                            <field name="chenh_lech_thang" widget="monetary" nolabel="1"/>
                                        </h2>
                                        <p class="mb-2" style="font-size: 1rem; font-weight: 500;">CH√äNH L·ªÜCH</p>
                                        <div class="mt-2 pt-2" style="border-top: 1px solid rgba(255,255,255,0.3); font-size: 0.85rem;">
                                            <i class="fa fa-info-circle"/> Thu - Chi
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="o_col-3 mb-3">
                                <div class="card shadow-sm border-0" style="border-left: 4px solid #8b5cf6 !important; background: linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%);">
                                    <div class="card-body text-center text-white py-4">
                                        <i class="fa fa-pie-chart fa-2x mb-2" style="opacity: 0.8;"/>
                                        <h2 style="font-size: 2rem; font-weight: bold; margin-bottom: 0.5rem;">
                                            <field name="ty_le_loi_nhuan" nolabel="1"/>%
                                        </h2>
                                        <p class="mb-2" style="font-size: 1rem; font-weight: 500;">T·ª∂ L·ªÜ L·ª¢I NHU·∫¨N</p>
                                        <div class="mt-2 pt-2" style="border-top: 1px solid rgba(255,255,255,0.3); font-size: 0.85rem;">
                                            <i class="fa fa-info-circle"/> (Ch√™nh l·ªách / Thu) √ó 100
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- C·∫¢NH B√ÅO N·∫æU CH√äNH L·ªÜCH √ÇM -->
                    <div class="alert alert-warning mb-4" role="alert" invisible="chenh_lech_thang &gt;= 0">
                        <h4 class="alert-heading"><i class="fa fa-exclamation-triangle"/> C·∫£nh b√°o: Chi v∆∞·ª£t Thu!</h4>
                        <p class="mb-0">
                            T·ªïng chi (<field name="tong_chi_thang" widget="monetary" nolabel="1"/>) 
                            l·ªõn h∆°n t·ªïng thu (<field name="tong_thu_thang" widget="monetary" nolabel="1"/>).
                            Ch√™nh l·ªách: <strong><field name="chenh_lech_thang" widget="monetary" nolabel="1"/></strong>
                        </p>
                        <hr/>
                        <p class="mb-0 small">
                            <i class="fa fa-lightbulb-o"/> <strong>L∆∞u √Ω:</strong> Dashboard ch·ªâ t√≠nh phi·∫øu <strong>ƒë√£ thu</strong> v√† <strong>ƒë√£ chi</strong>. 
                            Phi·∫øu ch·ªù duy·ªát/ƒë√£ duy·ªát ch∆∞a ƒë∆∞·ª£c t√≠nh v√†o.
                        </p>
                    </div>

                    <!-- PH·∫¶N 2: T·ªíN QU·ª∏ -->
                    <div class="mb-4">
                        <h3 style="color: #374151; font-weight: 600; margin-bottom: 1rem; padding: 0.75rem; background: #f9fafb; border-left: 4px solid #0891b2;">
                            üè¶ T·ªíN QU·ª∏ HI·ªÜN T·∫†I
                        </h3>
                        <div class="o_row mt-2 mb-3">
                            <div class="o_col-4 mb-3">
                                <div class="card shadow border-0 h-100" style="background: linear-gradient(135deg, #0891b2 0%, #0e7490 100%);">
                                    <div class="card-body text-center text-white py-4">
                                        <i class="fa fa-briefcase fa-3x mb-3" style="opacity: 0.9;"/>
                                        <h2 style="font-size: 2.5rem; font-weight: bold; margin-bottom: 0.5rem;">
                                            <field name="ton_quy_hien_tai" widget="monetary" nolabel="1"/>
                                        </h2>
                                        <p class="mb-0" style="font-size: 1.1rem; font-weight: 600;">T·ªîNG T·ªíN QU·ª∏</p>
                                        <p class="mb-0 mt-2" style="font-size: 0.85rem; opacity: 0.9;">
                                            <i class="fa fa-info-circle"/> Ti·ªÅn m·∫∑t + Ng√¢n h√†ng
                                        </p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="o_col-4 mb-3">
                                <div class="card shadow-sm border-0 h-100" style="border-top: 3px solid #f59e0b !important;">
                                    <div class="card-body text-center py-4">
                                        <i class="fa fa-money fa-3x mb-3" style="color: #f59e0b;"/>
                                        <h3 style="font-size: 2rem; font-weight: bold; color: #f59e0b; margin-bottom: 0.5rem;">
                                            <field name="ton_quy_tien_mat" widget="monetary" nolabel="1"/>
                                        </h3>
                                        <p class="mb-0" style="font-size: 1rem; color: #6b7280; font-weight: 500;">Ti·ªÅn m·∫∑t</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="o_col-4 mb-3">
                                <div class="card shadow-sm border-0 h-100" style="border-top: 3px solid #3b82f6 !important;">
                                    <div class="card-body text-center py-4">
                                        <i class="fa fa-university fa-3x mb-3" style="color: #3b82f6;"/>
                                        <h3 style="font-size: 2rem; font-weight: bold; color: #3b82f6; margin-bottom: 0.5rem;">
                                            <field name="ton_quy_ngan_hang" widget="monetary" nolabel="1"/>
                                        </h3>
                                        <p class="mb-0" style="font-size: 1rem; color: #6b7280; font-weight: 500;">Ng√¢n h√†ng</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- PH·∫¶N 3: TH·ªêNG K√ä PHI·∫æU THU -->
                    <div class="mb-4">
                        <h3 style="color: #374151; font-weight: 600; margin-bottom: 1rem; padding: 0.75rem; background: #f9fafb; border-left: 4px solid #10b981;">
                            üì• TH·ªêNG K√ä PHI·∫æU THU
                        </h3>
                        <div class="o_row mt-2 mb-3">
                            <div class="o_col-4 mb-3">
                                <div class="card shadow-sm border-0" style="border-top: 3px solid #10b981 !important;">
                                    <div class="card-body text-center py-4">
                                        <i class="fa fa-check-circle fa-3x mb-3" style="color: #10b981;"/>
                                        <h2 style="font-size: 2.5rem; font-weight: bold; color: #10b981; margin-bottom: 0.5rem;">
                                            <field name="so_phieu_thu_da_thu" nolabel="1"/>
                                        </h2>
                                        <p class="mb-0" style="font-size: 1rem; color: #6b7280; font-weight: 500;">Phi·∫øu ƒë√£ thu</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="o_col-4 mb-3">
                                <div class="card shadow-sm border-0" style="border-top: 3px solid #f59e0b !important;">
                                    <div class="card-body text-center py-4">
                                        <i class="fa fa-clock-o fa-3x mb-3" style="color: #f59e0b;"/>
                                        <h2 style="font-size: 2.5rem; font-weight: bold; color: #f59e0b; margin-bottom: 0.5rem;">
                                            <field name="so_phieu_thu_cho_thu" nolabel="1"/>
                                        </h2>
                                        <p class="mb-0" style="font-size: 1rem; color: #6b7280; font-weight: 500;">Phi·∫øu ch·ªù thu</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="o_col-4 mb-3">
                                <div class="card shadow border-0 h-100" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                                    <div class="card-body text-center text-white py-4">
                                        <i class="fa fa-calculator fa-3x mb-3" style="opacity: 0.9;"/>
                                        <h3 style="font-size: 1.8rem; font-weight: bold; margin-bottom: 0.5rem;">
                                            <field name="tong_tien_phieu_thu_cho" widget="monetary" nolabel="1"/>
                                        </h3>
                                        <p class="mb-0" style="font-size: 1rem; font-weight: 500;">Ti·ªÅn ch·ªù thu</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- PH·∫¶N 4: TH·ªêNG K√ä PHI·∫æU CHI -->
                    <div class="mb-4">
                        <h3 style="color: #374151; font-weight: 600; margin-bottom: 1rem; padding: 0.75rem; background: #f9fafb; border-left: 4px solid #ef4444;">
                            üì§ TH·ªêNG K√ä PHI·∫æU CHI
                        </h3>
                        <div class="o_row mt-2 mb-3">
                            <div class="o_col-4 mb-3">
                                <div class="card shadow-sm border-0" style="border-top: 3px solid #3b82f6 !important;">
                                    <div class="card-body text-center py-4">
                                        <i class="fa fa-check-square fa-3x mb-3" style="color: #3b82f6;"/>
                                        <h2 style="font-size: 2.5rem; font-weight: bold; color: #3b82f6; margin-bottom: 0.5rem;">
                                            <field name="so_phieu_chi_da_chi" nolabel="1"/>
                                        </h2>
                                        <p class="mb-0" style="font-size: 1rem; color: #6b7280; font-weight: 500;">Phi·∫øu ƒë√£ chi</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="o_col-4 mb-3">
                                <div class="card shadow-sm border-0" style="border-top: 3px solid #ef4444 !important;">
                                    <div class="card-body text-center py-4">
                                        <i class="fa fa-hourglass-half fa-3x mb-3" style="color: #ef4444;"/>
                                        <h2 style="font-size: 2.5rem; font-weight: bold; color: #ef4444; margin-bottom: 0.5rem;">
                                            <field name="so_phieu_chi_cho_chi" nolabel="1"/>
                                        </h2>
                                        <p class="mb-0" style="font-size: 1rem; color: #6b7280; font-weight: 500;">Phi·∫øu ch·ªù chi</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="o_col-4 mb-3">
                                <div class="card shadow border-0 h-100" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">
                                    <div class="card-body text-center text-white py-4">
                                        <i class="fa fa-calculator fa-3x mb-3" style="opacity: 0.9;"/>
                                        <h3 style="font-size: 1.8rem; font-weight: bold; margin-bottom: 0.5rem;">
                                            <field name="tong_tien_phieu_chi_cho" widget="monetary" nolabel="1"/>
                                        </h3>
                                        <p class="mb-0" style="font-size: 1rem; font-weight: 500;">Ti·ªÅn ch·ªù chi</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- PH·∫¶N 5: QU·∫¢N L√ù DUY·ªÜT PHI·∫æU -->
                    <div class="mb-4">
                        <h3 style="color: #374151; font-weight: 600; margin-bottom: 1rem; padding: 0.75rem; background: #f9fafb; border-left: 4px solid #8b5cf6;">
                            ‚úÖ QU·∫¢N L√ù DUY·ªÜT PHI·∫æU
                        </h3>
                        <div class="o_row mt-2 mb-3">
                            <div class="o_col-6 mb-3">
                                <button name="action_view_phieu_cho_duyet" type="object" class="btn btn-link p-0 w-100" style="text-decoration: none;">
                                    <div class="card shadow-sm border-0" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">
                                        <div class="card-body text-center text-white py-4">
                                            <i class="fa fa-hourglass-half fa-3x mb-3" style="opacity: 0.9;"/>
                                            <h2 style="font-size: 3rem; font-weight: bold; margin-bottom: 0.5rem;">
                                                <field name="so_phieu_cho_duyet" nolabel="1"/>
                                            </h2>
                                            <p class="mb-0" style="font-size: 1.2rem; font-weight: 600;">PHI·∫æU CH·ªú DUY·ªÜT</p>
                                            <p class="mb-0 mt-2" style="font-size: 0.85rem; opacity: 0.9;">
                                                <i class="fa fa-info-circle"/> G·ªìm phi·∫øu thu v√† phi·∫øu chi<br/>
                                                Click ƒë·ªÉ xem chi ti·∫øt
                                            </p>
                                        </div>
                                    </div>
                                </button>
                            </div>
                            
                            <div class="o_col-6 mb-3">
                                <button name="action_view_phieu_da_duyet" type="object" class="btn btn-link p-0 w-100" style="text-decoration: none;">
                                    <div class="card shadow-sm border-0" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                                        <div class="card-body text-center text-white py-4">
                                            <i class="fa fa-check-circle fa-3x mb-3" style="opacity: 0.9;"/>
                                            <h2 style="font-size: 3rem; font-weight: bold; margin-bottom: 0.5rem;">
                                                <field name="so_phieu_da_duyet" nolabel="1"/>
                                            </h2>
                                            <p class="mb-0" style="font-size: 1.2rem; font-weight: 600;">PHI·∫æU ƒê√É DUY·ªÜT</p>
                                            <p class="mb-0 mt-2" style="font-size: 0.9rem; opacity: 0.9;">
                                                <i class="fa fa-info-circle"/> ƒê√£ x·ª≠ l√Ω ‚Ä¢ Click ƒë·ªÉ xem
                                            </p>
                                        </div>
                                    </div>
                                </button>
                            </div>
                        </div>
                    </div>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Dashboard Action -->
    <record id="action_tai_chinh_dashboard" model="ir.actions.act_window">
        <field name="name">Dashboard T√†i ch√≠nh</field>
        <field name="res_model">tai.chinh.ke.toan.dashboard</field>
        <field name="view_mode">form</field>
        <field name="target">current</field>
    </record>

    <!-- Dashboard Kanban View -->
    <record id="view_dashboard_kanban" model="ir.ui.view">
        <field name="name">tai.chinh.ke.toan.dashboard.kanban</field>
        <field name="model">tai.chinh.ke.toan.dashboard</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_dashboard o_emphasize_colors" create="0" edit="0">
                <field name="tong_thu_thang"/>
                <field name="tong_chi_thang"/>
                <field name="chenh_lech_thang"/>
                <field name="ton_quy_hien_tai"/>
                <field name="ty_le_tang_giam_thu"/>
                <field name="ty_le_tang_giam_chi"/>
                <field name="so_phieu_cho_duyet"/>
                <field name="so_phieu_da_duyet"/>
                <templates>
                    <t t-name="kanban-box">
                        <div class="container o_kanban_card_content">
                            <div class="row">
                                <!-- T·ªïng thu -->
                                <div class="col-md-3 o_kanban_primary_left">
                                    <button class="btn btn-primary" type="object" name="action_view_so_quy">
                                        <div class="o_kanban_card_manage_stats">
                                            <div class="o_kanban_card_manage_title">
                                                <span>T·ªïng thu th√°ng n√†y</span>
                                            </div>
                                            <div class="o_kanban_primary_bottom bottom_block d-flex">
                                                <div class="o_value" style="font-size: 24px;">
                                                    <field name="tong_thu_thang" widget="monetary"/>
                                                </div>
                                            </div>
                                            <div t-if="record.ty_le_tang_giam_thu.raw_value != 0">
                                                <span t-if="record.ty_le_tang_giam_thu.raw_value > 0" class="badge badge-success">
                                                    <i class="fa fa-arrow-up"/> <field name="ty_le_tang_giam_thu"/>%
                                                </span>
                                                <span t-else="" class="badge badge-danger">
                                                    <i class="fa fa-arrow-down"/> <field name="ty_le_tang_giam_thu"/>%
                                                </span>
                                            </div>
                                        </div>
                                    </button>
                                </div>
                                
                                <!-- T·ªïng chi -->
                                <div class="col-md-3 o_kanban_primary_left">
                                    <button class="btn btn-warning" type="object" name="action_view_so_quy">
                                        <div class="o_kanban_card_manage_stats">
                                            <div class="o_kanban_card_manage_title">
                                                <span>T·ªïng chi th√°ng n√†y</span>
                                            </div>
                                            <div class="o_kanban_primary_bottom bottom_block d-flex">
                                                <div class="o_value" style="font-size: 24px;">
                                                    <field name="tong_chi_thang" widget="monetary"/>
                                                </div>
                                            </div>
                                            <div t-if="record.ty_le_tang_giam_chi.raw_value != 0">
                                                <span t-if="record.ty_le_tang_giam_chi.raw_value > 0" class="badge badge-danger">
                                                    <i class="fa fa-arrow-up"/> <field name="ty_le_tang_giam_chi"/>%
                                                </span>
                                                <span t-else="" class="badge badge-success">
                                                    <i class="fa fa-arrow-down"/> <field name="ty_le_tang_giam_chi"/>%
                                                </span>
                                            </div>
                                        </div>
                                    </button>
                                </div>
                                
                                <!-- Ch√™nh l·ªách -->
                                <div class="col-md-3">
                                    <div class="o_kanban_card_manage_stats">
                                        <div class="o_kanban_card_manage_title">
                                            <span>Ch√™nh l·ªách</span>
                                        </div>
                                        <div class="o_kanban_primary_bottom bottom_block d-flex">
                                            <div class="o_value" style="font-size: 24px;">
                                                <field name="chenh_lech_thang" 
                                                       widget="monetary"
                                                       decoration-success="chenh_lech_thang > 0"
                                                       decoration-danger="chenh_lech_thang &lt; 0"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- T·ªìn qu·ªπ -->
                                <div class="col-md-3">
                                    <button class="btn btn-success" type="object" name="action_view_so_quy">
                                        <div class="o_kanban_card_manage_stats">
                                            <div class="o_kanban_card_manage_title">
                                                <span>T·ªìn qu·ªπ hi·ªán t·∫°i</span>
                                            </div>
                                            <div class="o_kanban_primary_bottom bottom_block d-flex">
                                                <div class="o_value" style="font-size: 24px;">
                                                    <field name="ton_quy_hien_tai" widget="monetary"/>
                                                </div>
                                            </div>
                                        </div>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="row mt-3">
                                <!-- Phi·∫øu ch·ªù duy·ªát -->
                                <div class="col-md-6">
                                    <button class="btn btn-info btn-block" type="object" name="action_view_phieu_cho_duyet">
                                        <i class="fa fa-clock-o"/> Phi·∫øu ch·ªù duy·ªát: <strong><field name="so_phieu_cho_duyet"/></strong>
                                    </button>
                                </div>
                                
                                <!-- Phi·∫øu ƒë√£ duy·ªát -->
                                <div class="col-md-6">
                                    <div class="alert alert-secondary text-center">
                                        <i class="fa fa-check"/> Phi·∫øu ƒë√£ duy·ªát: <strong><field name="so_phieu_da_duyet"/></strong>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <!-- Dashboard Action -->
    <record id="action_dashboard" model="ir.actions.act_window">
        <field name="name">Dashboard</field>
        <field name="res_model">tai.chinh.ke.toan.dashboard</field>
        <field name="view_mode">kanban</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Dashboard t√†i ch√≠nh
            </p>
        </field>
    </record>

    <!-- Menu Item -->

</odoo>
